(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[935],{16638:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/addfile",function(){return n(10122)}])},10122:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var a=n(85893),r=n(67294),l=n(9230),o=n(46690),c=n(44961),s=n(33351),i=n(47568),u=n(41799),p=n(69396),d=n(34051),f=n.n(d),m=n(26953),h=n(48540),x=n(42660),g=n(11163),b=n(64146),w=n(60715),Z=n(42484),v=n.n(Z),N=(n(9669),n(15371),n(54372)),F=n(31838),I=function(){var e=(0,g.useRouter)(),t=(0,r.useState)(null),n=t[0],a=t[1],l=(0,r.useState)(),o=l[0],c=l[1],s=(0,r.useState)(),d=s[0],Z=s[1],I=(0,r.useState)(),C=I[0],S=I[1],T=(0,r.useState)(),y=T[0],M=T[1],_=(0,r.useState)(),E=_[0],j=_[1],A=(0,r.useState)({name:""}),J=A[0],O=A[1],U=function(){var e=(0,i.Z)(f().mark((function e(t){var n,r,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=J.name)&&t){e.next=3;break}return e.abrupt("return");case 3:return r=new x.j3({token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkaWQ6ZXRocjoweDA4Zjc4ODAwMkUzZDAwNEIxMDI3NTFGMUQ0OTJlNmI1NjNFODE3NmMiLCJpc3MiOiJuZnQtc3RvcmFnZSIsImlhdCI6MTY1MzA1NjE4NzM4MCwibmFtZSI6InBlbnNpb25maSJ9.agI-2V-FeK_eVRAZ-T6KGGfE9ltWrTUQ7brFzzYVwdM"}),e.prev=4,console.log("Trying to upload file to ipfs"),j("Uploading Item to IPFS & Filecoin via NFT.storage."),console.log("close to metadata"),e.next=10,r.store({name:n,description:n,image:t});case 10:return l=e.sent,S(l.url),console.log("metadata is: ",{metaData:l}),e.abrupt("return",l);case 16:e.prev=16,e.t0=e.catch(4),a("Could store file to NFT.Storage - Aborted file upload."),console.log("Error Uploading Content",e.t0);case 20:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=(0,i.Z)(f().mark((function e(t){var n,r,l,o,c;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j("Adding transaction to BitTorrent Chain (BTTC).."),n=new(v()),e.next=5,n.connect();case 5:return r=e.sent,l=new w.Q(r),o=new b.CH(F.E,N.Mt,l.getSigner()),console.log("Connected to contract",F.E),console.log("IPFS blockchain uri is ",t.url),e.next=12,o.createFile(t.url);case 12:return c=e.sent,console.log("File successfully created and added to Blockchain"),e.next=16,c.wait();case 16:return e.abrupt("return",c);case 19:e.prev=19,e.t0=e.catch(0),a("Failed to send tx to BitTorrent Chain (BTTC)."),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t){return e.apply(this,arguments)}}(),B=function(e,t){console.log("getIPFSGatewayURL2 two is ...");var n=G(e.data.image.pathname);console.log("image ipfs path is",n),Z(n),S(G(e.url)),M("https://testnet.bttcscan.com/tx/".concat(t.hash)),j("File addition was successfully!"),console.log("File preview completed")},D=function(){var t=(0,i.Z)(f().mark((function t(n,a){var r,l;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,U(a);case 3:return r=t.sent,t.next=6,z(r);case 6:l=t.sent,B(r,l),e.push("/dashboard");case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),G=function(e){var t=e.split("/");console.log("urlArray = ",t);var n="https://".concat(t[2],".ipfs.nftstorage.link/").concat(t[3]);return console.log("ipfsGateWayURL = ",n),n};return(0,m.tZ)(h.xu,{as:"section",sx:k.section},(0,m.tZ)("div",{className:"bg-purple-100 text-4xl text-center text-black font-bold pt-10"},(0,m.tZ)("h1",null," Add File")),(0,m.tZ)("div",{className:"flex justify-center bg-purple-100"},(0,m.tZ)("div",{className:"w-1/2 flex flex-col pb-12 "},(0,m.tZ)("input",{placeholder:"Give the file a name",className:"mt-5 border rounded p-4 text-xl",onChange:function(e){return O((0,p.Z)((0,u.Z)({},J),{name:e.target.value}))}}),(0,m.tZ)("br",null),(0,m.tZ)("div",{className:"MintNFT text-black text-xl"},(0,m.tZ)("form",null,(0,m.tZ)("h3",null,"Select a File"),(0,m.tZ)("input",{type:"file",onChange:function(e){console.log("file for upload selected..."),c(e.target.files[0]),j(""),Z(""),S(""),M("")},className:"text-black mt-2 border rounded text-xl"})),E&&(0,m.tZ)("p",null,E),C&&(0,m.tZ)("p",{className:"text-blue"},(0,m.tZ)("a",{href:C,className:"text-blue"},"Metadata on IPFS")),y&&(0,m.tZ)("p",null,(0,m.tZ)("a",{href:y,className:"text-blue"},"See the mint transaction")),n,d&&(0,m.tZ)("iframe",{className:"mb-10",title:"File",src:d,alt:"File preview",frameBorder:"0",scrolling:"auto",height:"50%",width:"100%"})),(0,m.tZ)("button",{type:"button",onClick:function(e){return D(e,o)},className:"font-bold mt-20 bg-purple-700 text-white text-2xl rounded p-4 shadow-lg"},"Publish File"))))},k={section:{backgroundColor:"primary",pt:[17,null,null,20,null],pb:[6,null,null,12,16]}};function C(){return(0,a.jsx)(l.f,{theme:o.Z,children:(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(c.Z,{title:"Add new file",description:"add a new file"}),(0,a.jsx)(I,{})]})})}},76647:function(){}},function(e){e.O(0,[277,826,563,216,764,669,991,381,451,774,888,179],(function(){return t=16638,e(e.s=t);var t}));var t=e.O();_N_E=t}]);